<!doctype html><html><head><meta charset=utf-8><meta http-equiv=content-type content=text/html><meta name=viewport content="maximum-scale=1, width=device-width, initial-scale=1"><title>Zompocalypse JS13K</title></head><body><div id=frame><canvas id=game width=256 height=72></canvas><canvas id=score width=128 height=72></canvas></div><script type=text/javascript>
function drawString(t,i){var e=i.canvas||GameCanvas;t=t.toUpperCase();var s=0,h=0;i.x&&(s=i.x),i.y&&(h=i.y),i.cx&&(s=i.cx-4*t.length/2),i.rx&&(s=i.rx-4*t.length),e.fillStyle=Colors.white,i.color&&(e.fillStyle=i.color);for(var o in t){var a=Font[t[o]],r=4*parseInt(o);for(var n in a)for(var l in a[n])if(1==a[n][l]){var d=parseInt(n)+h,m=r+parseInt(l)+s;e.fillRect(m,d,1,1)}}}window.Colors={red:"#C64444",white:"#EFF4F0",green1:"#96BB87",green2:"#79936C",green3:"#293833"},window.Font={0:[[0,1,0],[1,0,1],[1,0,1],[1,0,1],[0,1,0]],1:[[0,1,0],[1,1,0],[0,1,0],[0,1,0],[1,1,1]],2:[[0,1,0],[1,0,1],[0,0,1],[0,1,0],[1,1,1]],3:[[1,1,0],[0,0,1],[0,1,0],[0,0,1],[1,1,0]],4:[[1,0,1],[1,0,1],[1,1,1],[0,0,1],[0,0,1]],5:[[1,1,1],[1,0,0],[1,1,0],[0,0,1],[1,1,0]],6:[[0,1,1],[1,0,0],[1,1,0],[1,0,1],[0,1,0]],7:[[1,1,1],[1,0,1],[0,0,1],[0,1,0],[0,1,0]],8:[[0,1,0],[1,0,1],[0,1,0],[1,0,1],[0,1,0]],9:[[0,1,0],[1,0,1],[0,1,1],[0,0,1],[1,1,0]],A:[[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0]],B:[[1,1,0],[1,0,1],[1,1,0],[1,0,1],[1,1,0]],C:[[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0]],D:[[1,1,0],[1,0,1],[1,0,1],[1,0,1],[1,1,0]],E:[[1,1,1],[1,0,0],[1,1,0],[1,0,0],[1,1,1]],F:[[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0]],G:[[0,1,0],[1,0,0],[1,0,1],[1,0,1],[0,1,0]],H:[[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0]],I:[[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0]],J:[[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0]],K:[[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0]],L:[[1,0,0],[1,0,0],[1,0,0],[1,0,0],[1,1,1]],M:[[1,0,1],[1,1,1],[1,0,1],[1,0,1],[1,0,1]],N:[[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0]],O:[[0,1,0],[1,0,1],[1,0,1],[1,0,1],[0,1,0]],P:[[1,1,0],[1,0,1],[1,1,0],[1,0,0],[1,0,0]],Q:[[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0]],R:[[1,1,0],[1,0,1],[1,1,0],[1,0,1],[1,0,1]],S:[[0,1,1],[1,0,0],[0,1,0],[0,0,1],[1,1,0]],T:[[1,1,1],[0,1,0],[0,1,0],[0,1,0],[0,1,0]],U:[[1,0,1],[1,0,1],[1,0,1],[1,0,1],[0,1,0]],V:[[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0]],W:[[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0]],X:[[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0]],Y:[[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0]],Z:[[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0]],_:[[1,0,1],[1,1,1],[1,1,1],[1,1,1],[0,1,0]]},window.Controls={W:87,D:68,A:65,S:83,UP:38,DOWN:40,LEFT:37,RIGHT:39,SPACE:32},window.Loop=function(t){return function i(e){t(Math.min((Date.now()-e)/1e3,1)),window.requestAnimationFrame(i.bind(null,Date.now()))}(Date.now())},window.Keyboard={isDown:function(t){return void 0==this.data[t]&&(this.data[t]=-1),this.data[t]>=0},isJustDown:function(t){return void 0==this.data[t]&&(this.data[t]=-1),0==this.data[t]?(this.data[t]+=1,!0):!1},data:{}},document.addEventListener("keydown",function(t){-1==Keyboard.data[t.keyCode]&&(Keyboard.data[t.keyCode]=0)}),document.addEventListener("keyup",function(t){Keyboard.data[t.keyCode]=-1}),window.GameCanvas=document.getElementById("game").getContext("2d"),window.ScoreCanvas=document.getElementById("score").getContext("2d");var Hero=function(){this.x=16,this.y=48,this.vx=0,this.vy=0,this.width=4,this.height=6,this.direction=1,this.health=8,this.maxhealth=8,this.jumping=0,this.damaged=0,this.struggling=-1,this.hasDroppedBomb=!1,this.hasKilledZombie=!1,this.score=0,this.camera=0,game.hero=this};Hero.prototype.update=function(t){if(this.struggling>-1){var i=!1;for(var e in game.zombies){var s=game.zombies[e];if("attacking"==s.state){i=!0;break}}0==i&&(this.struggling=-1)}if(this.struggling>-1){if((Keyboard.isJustDown(Controls.S)||Keyboard.isJustDown(Controls.DOWN)||Keyboard.isJustDown(Controls.SPACE))&&(this.struggling+=1),(Keyboard.isJustDown(Controls.W)||Keyboard.isJustDown(Controls.UP))&&(this.struggling+=1),(Keyboard.isJustDown(Controls.A)||Keyboard.isJustDown(Controls.LEFT))&&(this.struggling+=1),(Keyboard.isJustDown(Controls.D)||Keyboard.isJustDown(Controls.RIGHT))&&(this.struggling+=1),this.struggling>=20){this.struggling=-1;for(var e in game.zombies){var s=game.zombies[e];"attacking"==s.state&&s.explode({x:this.x,y:this.y})}}}else(Keyboard.isJustDown(Controls.S)||Keyboard.isJustDown(Controls.DOWN)||Keyboard.isJustDown(Controls.SPACE))&&(1==this.hasKilledZombie||0==Object.keys(game.bombs).length)&&(new Bomb({x:this.x,y:this.y}),0==this.hasDroppedBomb&&(window.setTimeout(function(){game.hero.hasDroppedBomb=!0},500),window.setTimeout(function(){new Zombie({x:-2,y:62,direction:1})},1e3))),(Keyboard.isJustDown(Controls.W)||Keyboard.isJustDown(Controls.UP))&&(0==this.jumping?(this.vy=-3,this.jumping=1):1==this.jumping&&(this.vx=3*this.direction,this.jumping=2)),(Keyboard.isDown(Controls.A)||Keyboard.isDown(Controls.LEFT))&&2!=this.jumping&&(this.direction=-1,this.vx=-1),(Keyboard.isDown(Controls.D)||Keyboard.isDown(Controls.RIGHT))&&2!=this.jumping&&(this.direction=1,this.vx=1);this.vy+=8*t,this.y+this.vy>game.level.floor&&(this.y=game.level.floor,this.vy=0,this.jumping=0),this.x+this.vx<0&&(this.vx=0,this.x=0),1==this.hasKilledZombie?this.x+this.vx>game.level.width&&(this.x=game.level.width,this.vx=0):this.x+this.vx>128&&(this.x=128,this.vx=0),this.x+=this.vx,this.y+=this.vy;var h=5e-4;if(0!=this.jumping)var h=.5;if(this.vx<0?(this.vx*=Math.pow(h,t),this.vx>-.001&&(this.vx=0)):this.vx>0&&(this.vx*=Math.pow(h,t),this.vx<.001&&(this.vx=0)),this.damaged-=t,this.damaged<0&&(this.damaged=0),1==this.hasKilledZombie){var o=Math.round(game.hero.x-64)/8;o=Math.max(Math.min(o,game.level.width/8-16),0),Math.abs(this.camera-o)<.5&&(this.camera=o),this.camera<o?this.camera+=.5:this.camera>o&&(this.camera-=.5)}},Hero.prototype.hurt=function(){this.damaged<=0&&(this.health-=1,this.damaged=.1,this.health<=0&&(window.location=window.location))},Hero.prototype.render=function(){this.damaged<=0?GameCanvas.fillStyle=Colors.white:GameCanvas.fillStyle=Colors.red;var t=2!=this.jumping?this.width:this.height,i=2!=this.jumping?this.height:this.width,e=Math.round(this.x-t/2),s=Math.round(this.y-i);GameCanvas.fillRect(e,s,t,i)};var Bomb=function(t){this.x=t.x,this.y=t.y,this.vy=0,this.width=4,this.height=2,this.tick=0,this.primed=!1,this.id=window.gid++,game.bombs[this.id]=this};Bomb.prototype.update=function(t){this.tick+=t,this.tick>1.6&&(this.tick-=1.6,this.primed=!0),this.y+this.vy>game.level.floor&&(this.y=game.level.floor,this.vy=0),this.vy+=8*t,this.y+=this.vy,this.primed&&this.isColliding(game.hero)&&this.explode();for(var i in game.zombies){var e=game.zombies[i];this.isColliding(e)&&this.explode()}},Bomb.prototype.explode=function(){delete game.bombs[this.id],new Explosion({x:this.x,y:this.y,bomb:this});for(var t=-1;1>=t;t++)new Explosion({x:this.x+(Math.round(1.5*Math.random()*8*t)+4*t),y:this.y-(Math.round(8*Math.random())+(0==t?8:0)),bomb:this})},Bomb.prototype.isColliding=function(t){var i=Math.abs(t.x-this.x),e=Math.abs(t.y-this.y),s=t.width/2+this.width/2,h=t.height/2+this.height/2;return s>i&&h>e},Bomb.prototype.render=function(){this.tick<1.5?GameCanvas.fillStyle=Colors.white:GameCanvas.fillStyle=Colors.red;var t=Math.round(this.x-this.width/2),i=Math.round(this.y-this.height);GameCanvas.fillRect(t,i,this.width,this.height)};var Explosion=function(t){this.x=t.x,this.y=t.y,this.bx=t.bomb.x,this.by=t.bomb.y,this.diameter=32,this.tick=2,this.id=window.gid++,game.explosions[this.id]=this,this.isColliding(game.hero)&&game.hero.hurt();for(var i in game.zombies){var e=game.zombies[i];this.isColliding(e)&&e.explode({x:this.bx,y:this.by})}};Explosion.prototype.update=function(t){this.tick-=t,this.tick<=0&&delete game.explosions[this.id]},Explosion.prototype.isColliding=function(t){var i=Math.abs(t.x-this.x),e=Math.abs(t.y-this.y-t.height/2),s=this.diameter/2;return s>i&&s>e},Explosion.prototype.render=function(){GameCanvas.fillStyle=Colors.white,GameCanvas.beginPath();var t=this.diameter*(this.tick/2);GameCanvas.arc(this.x,this.y,t/2,0,2*Math.PI),GameCanvas.fill()};var Zombie=function(t){this.x=t.x,this.y=t.y||-2,this.vx=0,this.vy=0,this.width=4,this.height=6,this.direction=t.direction||1,this.id=window.gid++,game.zombies[this.id]=this,this.tick=0,this.y<game.level.floor&&(this.state="falling")};Zombie.prototype.update=function(t){if("falling"==this.state)this.y+=8*t,this.y>game.level.floor&&(this.y=game.level.floor,this.state="moving");else if("moving"==this.state)this.x+=22*this.direction*t,this.x<0?(this.x=0,this.direction=1):this.x>game.level.width&&(this.x=game.level.width,this.direction=-1),this.isColliding(game.hero)&&(this.state="attacking",game.hero.struggling=0,game.hero.vx=0,game.hero.vy=1);else if("attacking"==this.state)this.tick+=t,this.tick>1.5&&(this.tick-=1.5,game.hero.hurt());else if("dying"==this.state){if(this.vy+=5*t,this.y+this.vy>game.level.floor){this.y=game.level.floor;for(var i=0;15>i;i++)new Particle({x:this.x+Math.round(3*Math.random()-1.5),y:this.y,vx:1*Math.random()-.5,vy:-1*Math.random()*2.5,type:i%2});return delete game.zombies[this.id],game.hero.score+=10,void(0==game.hero.hasKilledZombie&&window.setTimeout(function(){game.hero.hasKilledZombie=!0;for(var t=1;15>t;t++)new Zombie({y:-2-48*Math.random(),x:2*t*8+(2*Math.random()-1),direction:Math.random()<.5?1:-1})},1e3))}if(this.x+this.vx<0){this.x=0;for(var i=0;15>i;i++)new Particle({x:this.x,y:this.y+Math.round(3*Math.random()-1.5),vx:1*Math.random(),vy:-1*Math.random()*2.5,type:i%2});return delete game.zombies[this.id],game.hero.score+=10,void(0==game.hero.hasKilledZombie&&window.setTimeout(function(){game.hero.hasKilledZombie=!0},1e3))}if(this.x+this.vx>game.level.width){this.x=game.level.width;for(var i=0;15>i;i++)new Particle({x:this.x,y:this.y+Math.round(3*Math.random()-1.5),vx:-1*Math.random(),vy:-1*Math.random()*2.5,type:i%2});return delete game.zombies[this.id],game.hero.score+=10,void(0==game.hero.hasKilledZombie&&window.setTimeout(function(){game.hero.hasKilledZombie=!0},1e3))}this.x+=this.vx,this.y+=this.vy}},Zombie.prototype.explode=function(t){this.state="dying",this.x<t.x?(this.direction=-1,this.vx=-(.5*Math.random()+1)):(this.direction=1,this.vx=+(.5*Math.random()+1)),this.vy=-(.5*Math.random()+2.75)},Zombie.prototype.isColliding=function(t){var i=Math.abs(t.x-this.x),e=Math.abs(t.y-this.y),s=t.width/2+this.width/2,h=t.height/2+this.height/2;return s>i&&h>e},Zombie.prototype.render=function(){GameCanvas.fillStyle=Colors.green1;var t="dying"!=this.state?this.height:this.width,i="dying"!=this.state?this.width:this.height;"attacking"==this.state&&(t-=1);var e=Math.round(this.x-i/2),s=Math.round(this.y-t);GameCanvas.fillRect(e,s,i,t)};var Particle=function(t){this.x=t.x,this.y=t.y,this.vx=t.vx,this.vy=t.vy,this.type=t.type,this.id=window.gid++,game.particles[this.id]=this};Particle.prototype.update=function(t){this.vy+=8*t,this.y+this.vy>game.level.floor&&(this.y=game.level.floor,this.vx=0,this.vy=0),this.x+this.vx<0&&(this.x=0,this.vx=0),this.x+this.vx>game.level.width&&(this.x=game.level.width,this.vx=0),this.x+=this.vx,this.y+=this.vy},Particle.prototype.render=function(){0==this.type?GameCanvas.fillStyle=Colors.red:GameCanvas.fillStyle=Colors.green1;var t=Math.round(this.x),i=Math.round(this.y);GameCanvas.fillRect(t,i-1,1,1)};var Level=function(){this.width=256,this.height=72,this.floor=this.height-9,game.level=this,this.tiles=[];for(var t=0;t<this.width/8;){var i=Math.floor(5*Math.random());0==i?(this.tiles.push({x:8*t,y:this.floor+1,width:7,height:7}),t++):1==i?(this.tiles.push({x:8*t,y:this.floor+1,width:7,height:3}),this.tiles.push({x:8*t,y:this.floor+1+4,width:7,height:3}),t++):2==i?(this.tiles.push({x:8*t,y:this.floor+1,width:3,height:7}),this.tiles.push({x:8*t+4,y:this.floor+1,width:3,height:7}),t++):3==i?(this.tiles.push({x:8*t,y:this.floor+1,width:3,height:3}),this.tiles.push({x:8*t+4,y:this.floor+1,width:3,height:3}),this.tiles.push({x:8*t,y:this.floor+1+4,width:3,height:3}),this.tiles.push({x:8*t+4,y:this.floor+1+4,width:3,height:3}),t++):4==i&&(this.tiles.push({x:8*t,y:this.floor+1,width:3,height:7}),this.tiles.push({x:8*t,y:this.floor+1+4,width:7,height:3}),this.tiles.push({x:8*(t+.5),y:this.floor+1,width:7,height:3}),this.tiles.push({x:8*(t+1),y:this.floor+1+4,width:7,height:3}),this.tiles.push({x:8*(t+2),y:this.floor+1,width:3,height:7}),this.tiles.push({x:8*(t+1.5),y:this.floor+1,width:7,height:3}),t+=2.5)}};Level.prototype.render=function(){GameCanvas.fillStyle=Colors.green1,GameCanvas.fillRect(0,this.floor,this.width,9);for(var t in this.tiles){var i=this.tiles[t];GameCanvas.fillStyle=Colors.green2,GameCanvas.fillRect(i.x,i.y,i.width,i.height)}},window.gid=0;var Game=function(){this.hero=null,this.level=null,this.zombies={},this.bombs={},this.explosions={},this.particles={},this.maxzombies=8};Game.prototype.update=function(t){this.hero.update(t);for(var i in this.zombies)this.zombies[i].update(t);for(var i in this.bombs)this.bombs[i].update(t);for(var i in this.explosions)this.explosions[i].update(t);for(var i in this.particles)this.particles[i].update(t);this.maxzombies=Math.max(this.maxzombies,Math.floor(this.hero.score/20)),1==this.hero.hasKilledZombie&&Object.keys(this.zombies).length<game.maxzombies&&new Zombie({y:-2-48*Math.random(),x:Math.random()*(game.level.width-16)+16,direction:Math.random()<.5?1:-1})},Game.prototype.render=function(){this.hero.render();for(var t in this.zombies)this.zombies[t].render();for(var t in this.particles)this.particles[t].render();for(var t in this.bombs)this.bombs[t].render();for(var t in this.explosions)this.explosions[t].render();if(this.level.render(),0==this.hero.hasDroppedBomb){drawString("DROP BOMB",{cx:38,y:28}),GameCanvas.fillStyle=Colors.white,GameCanvas.beginPath();var i=37,e=36,s=e+15;GameCanvas.moveTo(i,e),GameCanvas.lineTo(i-1,e+1),GameCanvas.lineTo(i-1,s-4),GameCanvas.lineTo(i-3,s-4),GameCanvas.lineTo(i,s),GameCanvas.lineTo(i+3,s-4),GameCanvas.lineTo(i+1,s-4),GameCanvas.lineTo(i+1,e+7),GameCanvas.closePath(),GameCanvas.fill()}this.hero.score>0&&drawString(this.hero.score+"",{x:2,y:2,canvas:ScoreCanvas});for(var h="",o=0;o<game.hero.health;o++)h+="_";drawString(h,{rx:126,y:2,color:Colors.red,canvas:ScoreCanvas}),game.hero.struggling>-1&&drawString("STRUGGLE",{cx:Math.round(game.hero.x+1-Math.random()),y:Math.round(game.hero.y-game.hero.height-7-Math.random()),color:Colors.red}),this.hero.damaged>.05&&(GameCanvas.fillStyle="rgba(198, 68, 68, 0.75)",GameCanvas.fillRect(0,0,game.level.width,72)),document.getElementById("game").style.left=-game.hero.camera+"em"},window.game=new Game,new Level({}),new Hero({}),Loop(function(t){game.update(t),GameCanvas.clearRect(0,0,game.level.width,72),ScoreCanvas.clearRect(0,0,128,72),game.render(t)});
</script><style>
*{margin:0;padding:0;cursor:default;user-select:none;box-sizing:border-box}html{color:#EEE;background-color:#111}#frame{top:0;left:0;right:0;bottom:0;margin:auto;position:fixed;overflow:hidden;background-color:#293833}@media(min-aspect-ratio:16/9){#frame{height:100vh;width:177.778vh;font-size:11.111vh}}@media(max-aspect-ratio:16/9){#frame{width:100vw;height:56.25vw;font-size:6.25vw}}canvas{top:0;height:100%;position:absolute;image-rendering:pixelated}
</style></body></html>